<!-- admin.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Admin Mission Uploader</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <h2>Admin Mission Upload</h2>
    <input type="text" id="codename" placeholder="Codename">
    <input type="text" id="passcode" placeholder="Passcode">
    <textarea id="mission" placeholder="Enter mission text here..."></textarea>
    <button onclick="submitMission()">Submit Mission</button>
    <p id="status"></p>
  </div>

  <script type="module">
    import { db, doc, setDoc } from './scripts/firebase.js';

    async function submitMission() {
      const codename = document.getElementById("codename").value.trim().toLowerCase();
      const passcode = document.getElementById("passcode").value.trim().toLowerCase();
      const mission = document.getElementById("mission").value.trim();
      const statusEl = document.getElementById("status");

      if (!codename || !passcode || !mission) {
        statusEl.textContent = "Please fill all fields.";
        return;
      }

      const key = `${codename}|${passcode}`;

      try {
        await setDoc(doc(db, "agents", key), { mission });
        statusEl.textContent = "Mission successfully uploaded.";
      } catch (error) {
        console.error("Error writing document: ", error);
        statusEl.textContent = "Error uploading mission.";
      }
    }

    window.submitMission = submitMission;
  </script>
</body>
</html>
